# 部署检查清单 ✅

## 🔍 部署前检查

### 代码质量
- [ ] 本地构建成功 (`npm run build`)
- [ ] 类型检查通过 (`npm run type-check`)
- [ ] 所有功能本地测试正常
- [ ] 代码已推送到 GitHub

### 环境配置
- [ ] `.env.example` 文件已更新
- [ ] 生产环境变量已准备
- [ ] JWT_SECRET 使用强密钥
- [ ] 数据库配置已确认

## 🚀 Vercel 部署步骤

### 1. 项目设置
- [ ] GitHub 仓库已连接
- [ ] 构建设置正确
- [ ] 部署分支已选择

### 2. 数据库配置
- [ ] Postgres 数据库已创建
- [ ] 环境变量自动配置
- [ ] 连接测试成功

### 3. 环境变量配置
#### 必需变量
- [ ] `JWT_SECRET` - JWT签名密钥
- [ ] `DB_INIT_KEY` - 数据库初始化密钥
- [ ] `OPENAI_API_KEY` - OpenAI API密钥
- [ ] `OPENAI_API_BASE` - API基础URL
- [ ] `OPENAI_MODEL` - 使用的模型

#### 可选变量
- [ ] `NEXT_PUBLIC_USE_USER_KEY` - 用户密钥模式
- [ ] `SMTP_HOST` - 邮箱服务器
- [ ] `SMTP_PORT` - 邮箱端口
- [ ] `SMTP_USER` - 邮箱用户名
- [ ] `SMTP_PASS` - 邮箱密码
- [ ] `SMTP_FROM` - 发件人地址

## 🗄️ 部署后检查

### 1. 基础功能
- [ ] 网站可以正常访问
- [ ] 首页加载正常
- [ ] 静态资源加载正常

### 2. 数据库初始化
- [ ] 访问 `/init-db` 页面
- [ ] 数据库初始化成功
- [ ] 管理员账户创建成功

### 3. 认证系统测试
#### 登录功能
- [ ] 管理员账户登录成功
  - 邮箱：`admin@example.com`
  - 用户名：`admin`
  - 密码：`admin123`
- [ ] 用户状态显示正确
- [ ] 登出功能正常

#### 注册功能
- [ ] 注册页面正常显示
- [ ] 邮箱验证码发送（检查日志）
- [ ] 注册流程完整
- [ ] 新用户可以正常登录

### 4. 核心功能测试
- [ ] 周报生成功能正常
- [ ] Markdown渲染正确
- [ ] Token使用量统计正常
- [ ] 个人中心数据正确

### 5. 邮箱系统测试
#### 开发模式（默认）
- [ ] 验证码输出到日志
- [ ] 欢迎邮件内容正确

#### 生产模式（如果配置了SMTP）
- [ ] 验证码邮件发送成功
- [ ] 欢迎邮件发送成功
- [ ] 邮件格式正确

## 🔧 性能检查

### 页面性能
- [ ] 首页加载时间 < 3秒
- [ ] 静态资源缓存正常
- [ ] 图片优化生效

### API性能
- [ ] 登录API响应 < 1秒
- [ ] 注册API响应 < 2秒
- [ ] 生成API响应合理

### 数据库性能
- [ ] 查询响应时间正常
- [ ] 连接池配置合理
- [ ] 索引使用正确

## 🛡️ 安全检查

### 认证安全
- [ ] JWT密钥足够复杂
- [ ] Cookie设置HttpOnly
- [ ] 密码哈希强度足够

### API安全
- [ ] 输入验证完整
- [ ] 错误信息不泄露敏感信息
- [ ] 速率限制（如需要）

### 数据安全
- [ ] 数据库连接加密
- [ ] 敏感信息不在日志中
- [ ] 环境变量安全存储

## 📊 监控设置

### Vercel监控
- [ ] 函数日志正常
- [ ] 错误监控启用
- [ ] 性能指标正常

### 自定义监控（可选）
- [ ] 错误追踪服务
- [ ] 用户行为分析
- [ ] 性能监控工具

## 🔄 备份和恢复

### 数据备份
- [ ] 数据库备份策略
- [ ] 环境变量备份
- [ ] 代码版本控制

### 恢复测试
- [ ] 数据库恢复测试
- [ ] 配置恢复测试
- [ ] 回滚流程测试

## 📝 文档检查

### 用户文档
- [ ] README.md 更新
- [ ] 使用指南完整
- [ ] 常见问题解答

### 开发文档
- [ ] API文档更新
- [ ] 部署文档完整
- [ ] 故障排除指南

## 🎯 最终验证

### 用户体验
- [ ] 新用户注册流程顺畅
- [ ] 老用户登录正常
- [ ] 核心功能可用
- [ ] 错误处理友好

### 管理功能
- [ ] 管理员权限正确
- [ ] 用户统计准确
- [ ] 系统监控正常

---

## ✅ 部署完成确认

当所有检查项都完成后，你的 Weekly Report GPT 就可以正式上线了！

**默认管理员账户信息：**
- 邮箱：admin@example.com
- 用户名：admin
- 密码：admin123

**重要提醒：**
1. 生产环境请修改默认管理员密码
2. 定期备份数据库
3. 监控系统性能和错误日志
4. 及时更新依赖包

🎉 恭喜！你的智能周报生成系统已经成功部署！